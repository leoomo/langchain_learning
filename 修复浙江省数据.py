#!/usr/bin/env python3
"""
ä¿®å¤æµ™æ±Ÿçœåœ°åŒºæ•°æ®
åŒ…æ‹¬æ­å·å¸‚ã€å®æ³¢å¸‚ã€æ¸©å·å¸‚ç­‰é‡è¦åŸå¸‚å’ŒåŒºå¿çš„æ­£ç¡®æ•°æ®
"""

import sqlite3
from pathlib import Path
import logging

# è®¾ç½®æ—¥å¿—
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

def fix_zhejiang_data():
    """ä¿®å¤æµ™æ±Ÿçœæ•°æ®"""
    db_path = "data/admin_divisions.db"

    if not Path(db_path).exists():
        logger.error("âŒ æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨")
        return

    conn = sqlite3.connect(db_path)
    cursor = conn.cursor()

    # æµ™æ±Ÿçœå®Œæ•´åœ°çº§å¸‚å’ŒåŒºå¿æ•°æ®
    zhejiang_data = [
        # çœçº§
        ("330000", "æµ™æ±Ÿçœ", None, 1, 120.1534, 30.2651, "zhejiang", '[\"æµ™\"]', "æµ™æ±Ÿçœ", None, None, None),

        # åœ°çº§å¸‚
        ("330100", "æ­å·å¸‚", "330000", 2, 120.1551, 30.2741, "hangzhou", '[\"æ­\", \"æ­¦æ—\", \"é’±å¡˜\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", None, None),
        ("330200", "å®æ³¢å¸‚", "330000", 2, 121.5439, 29.8683, "ningbo", '[\"ç”¬\", \"ç”¬åŸ\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", None, None),
        ("330300", "æ¸©å·å¸‚", "330000", 2, 120.6994, 27.9944, "wenzhou", '[\"é¹¿åŸ\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", None, None),
        ("330400", "å˜‰å…´å¸‚", "330000", 2, 120.7509, 30.7627, "jiaxing", '[\"ç¦¾åŸ\"]', "æµ™æ±Ÿçœ", "å˜‰å…´å¸‚", None, None),
        ("330500", "æ¹–å·å¸‚", "330000", 2, 120.1024, 30.8672, "huzhou", '[\"æ¹–åŸ\"]', "æµ™æ±Ÿçœ", "æ¹–å·å¸‚", None, None),
        ("330600", "ç»å…´å¸‚", "330000", 2, 120.5821, 30.0293, "shaoxing", '[\"è¶Šå·\", \"ç»å…´\"]', "æµ™æ±Ÿçœ", "ç»å…´å¸‚", None, None),
        ("330700", "é‡‘åå¸‚", "330000", 2, 119.6495, 29.0895, "jinhua", '[\"å©ºå·\"]', "æµ™æ±Ÿçœ", "é‡‘åå¸‚", None, None),
        ("330800", "è¡¢å·å¸‚", "330000", 2, 118.8724, 28.9417, "quzhou", '[\"æŸ¯åŸ\", \"ä¿¡å®‰\"]', "æµ™æ±Ÿçœ", "è¡¢å·å¸‚", None, None),
        ("330900", "èˆŸå±±å¸‚", "330000", 2, 122.2072, 29.9853, "zhoushan", '[\"æµ·å¤©ä½›å›½\", \"æ¸”éƒ½\"]', "æµ™æ±Ÿçœ", "èˆŸå±±å¸‚", None, None),
        ("331000", "å°å·å¸‚", "330000", 2, 121.4286, 28.6614, "taizhou_zj", '[\"å°å·\"]', "æµ™æ±Ÿçœ", "å°å·å¸‚", None, None),
        ("331100", "ä¸½æ°´å¸‚", "330000", 2, 119.9218, 28.4519, "lishui", '[\"æ‹¬å·\", \"è²åŸ\"]', "æµ™æ±Ÿçœ", "ä¸½æ°´å¸‚", None, None),

        # æ­å·å¸‚åŒºå¿
        ("330102", "ä¸ŠåŸåŒº", "330100", 3, 120.1699, 30.2544, "shangcheng", '[\"ä¸ŠåŸ\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "ä¸ŠåŸåŒº", None),
        ("330103", "ä¸‹åŸåŒº", "330100", 3, 120.1699, 30.2544, "xiacheng", '[\"ä¸‹åŸ\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "ä¸‹åŸåŒº", None),
        ("330104", "æ±Ÿå¹²åŒº", "330100", 3, 120.1699, 30.2544, "jianggan", '[\"æ±Ÿå¹²\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "æ±Ÿå¹²åŒº", None),
        ("330105", "æ‹±å¢…åŒº", "330100", 3, 120.1699, 30.2544, "gongshu", '[\"æ‹±å¢…\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "æ‹±å¢…åŒº", None),
        ("330106", "è¥¿æ¹–åŒº", "330100", 3, 120.1551, 30.2741, "xihu", '[\"è¥¿æ¹–\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "è¥¿æ¹–åŒº", None),
        ("330108", "æ»¨æ±ŸåŒº", "330100", 3, 120.1699, 30.2544, "binjiang", '[\"æ»¨æ±Ÿ\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "æ»¨æ±ŸåŒº", None),
        ("330109", "è§å±±åŒº", "330100", 3, 120.2713, 30.1637, "xiaoshan", '[\"è§å±±\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "è§å±±åŒº", None),
        ("330110", "ä½™æ­åŒº", "330100", 3, 120.2999, 30.4182, "yuhang", '[\"ä½™æ­\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "ä½™æ­åŒº", None),  # ä¿®å¤ä½™æ­åŒºåæ ‡
        ("330111", "å¯Œé˜³åŒº", "330100", 3, 119.9598, 30.0488, "fuyang", '[\"å¯Œé˜³\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "å¯Œé˜³åŒº", None),
        ("330112", "ä¸´å®‰åŒº", "330100", 3, 119.7242, 30.2335, "linan", '[\"ä¸´å®‰\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "ä¸´å®‰åŒº", None),
        ("330113", "ä¸´å¹³åŒº", "330100", 3, 120.2867, 30.4183, "linping", '[\"ä¸´å¹³\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "ä¸´å¹³åŒº", None),
        ("330114", "é’±å¡˜åŒº", "330100", 3, 120.5094, 30.3095, "qiantang", '[\"é’±å¡˜\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "é’±å¡˜åŒº", None),
        ("330122", "æ¡åºå¿", "330100", 3, 119.6889, 29.7986, "tonglu", '[\"æ¡åº\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "æ¡åºå¿", None),
        ("330127", "æ·³å®‰å¿", "330100", 3, 119.0426, 29.6089, "chunan", '[\"æ·³å®‰\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "æ·³å®‰å¿", None),
        ("330182", "å»ºå¾·å¸‚", "330100", 3, 119.2811, 29.4760, "jiande", '[\"å»ºå¾·\"]', "æµ™æ±Ÿçœ", "æ­å·å¸‚", "å»ºå¾·å¸‚", None),

        # å®æ³¢å¸‚åŒºå¿
        ("330203", "æµ·æ›™åŒº", "330200", 3, 121.5511, 29.8599, "haishu", '[\"æµ·æ›™\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", "æµ·æ›™åŒº", None),
        ("330205", "æ±ŸåŒ—åŒº", "330200", 3, 121.5550, 29.8855, "jiangbei_nb", '[\"æ±ŸåŒ—\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", "æ±ŸåŒ—åŒº", None),
        ("330206", "åŒ—ä»‘åŒº", "330200", 3, 121.8444, 29.9061, "beilun", '[\"åŒ—ä»‘\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", "åŒ—ä»‘åŒº", None),
        ("330211", "é•‡æµ·åŒº", "330200", 3, 121.7161, 29.9491, "zhenhai", '[\"é•‡æµ·\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", "é•‡æµ·åŒº", None),
        ("330212", "é„å·åŒº", "330200", 3, 121.5497, 29.8314, "yinzhou", '[\"é„å·\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", "é„å·åŒº", None),
        ("330213", "å¥‰åŒ–åŒº", "330200", 3, 121.4011, 29.6520, "fenghua", '[\"å¥‰åŒ–\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", "å¥‰åŒ–åŒº", None),
        ("330225", "è±¡å±±å¿", "330200", 3, 121.8692, 29.4760, "xiangshan", '[\"è±¡å±±\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", "è±¡å±±å¿", None),
        ("330226", "å®æµ·å¿", "330200", 3, 121.4308, 29.3151, "ninghai", '[\"å®æµ·\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", "å®æµ·å¿", None),
        ("330281", "ä½™å§šå¸‚", "330200", 3, 121.1539, 30.0375, "yuyao", '[\"ä½™å§š\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", "ä½™å§šå¸‚", None),
        ("330282", "æ…ˆæºªå¸‚", "330200", 3, 121.2371, 30.1697, "cixi", '[\"æ…ˆæºª\"]', "æµ™æ±Ÿçœ", "å®æ³¢å¸‚", "æ…ˆæºªå¸‚", None),

        # æ¸©å·å¸‚åŒºå¿
        ("330302", "é¹¿åŸåŒº", "330300", 3, 120.6721, 28.0004, "lucheng", '[\"é¹¿åŸ\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "é¹¿åŸåŒº", None),
        ("330303", "é¾™æ¹¾åŒº", "330300", 3, 120.8306, 27.9123, "longwan", '[\"é¾™æ¹¾\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "é¾™æ¹¾åŒº", None),
        ("330304", "ç“¯æµ·åŒº", "330300", 3, 120.6385, 28.0071, "ouhai", '[\"ç“¯æµ·\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "ç“¯æµ·åŒº", None),
        ("330305", "æ´å¤´åŒº", "330300", 3, 121.1568, 27.8363, "dongtou", '[\"æ´å¤´\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "æ´å¤´åŒº", None),
        ("330324", "æ°¸å˜‰å¿", "330300", 3, 120.6932, 28.1541, "yongjia", '[\"æ°¸å˜‰\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "æ°¸å˜‰å¿", None),
        ("330326", "å¹³é˜³å¿", "330300", 3, 120.5651, 27.6623, "pingyang", '[\"å¹³é˜³\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "å¹³é˜³å¿", None),
        ("330327", "è‹å—å¿", "330300", 3, 120.8335, 27.5174, "cangnan", '[\"è‹å—\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "è‹å—å¿", None),
        ("330328", "æ–‡æˆå¿", "330300", 3, 120.0907, 27.7868, "wencheng", '[\"æ–‡æˆ\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "æ–‡æˆå¿", None),
        ("330329", "æ³°é¡ºå¿", "330300", 3, 120.0315, 27.5568, "taishun", '[\"æ³°é¡º\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "æ³°é¡ºå¿", None),
        ("330381", "ç‘å®‰å¸‚", "330300", 3, 120.6474, 27.7785, "ruian", '[\"ç‘å®‰\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "ç‘å®‰å¸‚", None),
        ("330382", "ä¹æ¸…å¸‚", "330300", 3, 120.9617, 28.1240, "yueqing", '[\"ä¹æ¸…\"]', "æµ™æ±Ÿçœ", "æ¸©å·å¸‚", "ä¹æ¸…å¸‚", None),

        # ç»å…´å¸‚åŒºå¿
        ("330602", "è¶ŠåŸåŒº", "330600", 3, 120.5819, 30.0046, "yuecheng", '[\"è¶ŠåŸ\"]', "æµ™æ±Ÿçœ", "ç»å…´å¸‚", "è¶ŠåŸåŒº", None),
        ("330603", "æŸ¯æ¡¥åŒº", "330600", 3, 120.4954, 30.0816, "keqiao", '[\"æŸ¯æ¡¥\"]', "æµ™æ±Ÿçœ", "ç»å…´å¸‚", "æŸ¯æ¡¥åŒº", None),
        ("330604", "ä¸Šè™åŒº", "330600", 3, 120.8686, 30.0336, "shangyu", '[\"ä¸Šè™\"]', "æµ™æ±Ÿçœ", "ç»å…´å¸‚", "ä¸Šè™åŒº", None),
        ("330624", "æ–°æ˜Œå¿", "330600", 3, 120.9044, 29.4999, "xinchang", '[\"æ–°æ˜Œ\"]', "æµ™æ±Ÿçœ", "ç»å…´å¸‚", "æ–°æ˜Œå¿", None),
        ("330681", "è¯¸æš¨å¸‚", "330600", 3, 120.2325, 29.7136, "zhuji", '[\"è¯¸æš¨\"]', "æµ™æ±Ÿçœ", "ç»å…´å¸‚", "è¯¸æš¨å¸‚", None),
        ("330683", "åµŠå·å¸‚", "330600", 3, 120.8316, 29.5610, "shengzhou", '[\"åµŠå·\"]', "æµ™æ±Ÿçœ", "ç»å…´å¸‚", "åµŠå·å¸‚", None),

        # æ¹–å·å¸‚åŒºå¿
        ("330502", "å´å…´åŒº", "330500", 3, 120.1024, 30.8672, "wuxing", '[\"å´å…´\"]', "æµ™æ±Ÿçœ", "æ¹–å·å¸‚", "å´å…´åŒº", None),
        ("330503", "å—æµ”åŒº", "330500", 3, 120.4202, 30.8669, "nanxun", '[\"å—æµ”\"]', "æµ™æ±Ÿçœ", "æ¹–å·å¸‚", "å—æµ”åŒº", None),
        ("330521", "å¾·æ¸…å¿", "330500", 3, 120.0844, 30.5342, "deqing", '[\"å¾·æ¸…\"]', "æµ™æ±Ÿçœ", "æ¹–å·å¸‚", "å¾·æ¸…å¿", None),
        ("330522", "é•¿å…´å¿", "330500", 3, 119.9077, 31.0060, "changxing", '[\"é•¿å…´\"]', "æµ™æ±Ÿçœ", "æ¹–å·å¸‚", "é•¿å…´å¿", None),
        ("330523", "å®‰å‰å¿", "330500", 3, 119.6816, 30.6379, "anji", '[\"å®‰å‰\"]', "æµ™æ±Ÿçœ", "æ¹–å·å¸‚", "å®‰å‰å¿", None),

        # å˜‰å…´å¸‚åŒºå¿
        ("330402", "å—æ¹–åŒº", "330400", 3, 120.7509, 30.7627, "nanhu", '[\"å—æ¹–\"]', "æµ™æ±Ÿçœ", "å˜‰å…´å¸‚", "å—æ¹–åŒº", None),
        ("330411", "ç§€æ´²åŒº", "330400", 3, 120.7087, 30.7645, "xiuzhou", '[\"ç§€æ´²\"]', "æµ™æ±Ÿçœ", "å˜‰å…´å¸‚", "ç§€æ´²åŒº", None),
        ("330421", "å˜‰å–„å¿", "330400", 3, 120.9258, 30.8297, "jiashan", '[\"å˜‰å–„\"]', "æµ™æ±Ÿçœ", "å˜‰å…´å¸‚", "å˜‰å–„å¿", None),
        ("330424", "æµ·ç›å¿", "330400", 3, 120.9457, 30.5255, "haiyan", '[\"æµ·ç›\"]', "æµ™æ±Ÿçœ", "å˜‰å…´å¸‚", "æµ·ç›å¿", None),
        ("330481", "æµ·å®å¸‚", "330400", 3, 120.6813, 30.5097, "haining", '[\"æµ·å®\"]', "æµ™æ±Ÿçœ", "å˜‰å…´å¸‚", "æµ·å®å¸‚", None),
        ("330482", "å¹³æ¹–å¸‚", "330400", 3, 121.0217, 30.6964, "pinghu", '[\"å¹³æ¹–\"]', "æµ™æ±Ÿçœ", "å˜‰å…´å¸‚", "å¹³æ¹–å¸‚", None),
        ("330483", "æ¡ä¹¡å¸‚", "330400", 3, 120.5649, 30.6303, "tongxiang", '[\"æ¡ä¹¡\"]', "æµ™æ±Ÿçœ", "å˜‰å…´å¸‚", "æ¡ä¹¡å¸‚", None),

        # é‡‘åå¸‚åŒºå¿
        ("330702", "å©ºåŸåŒº", "330700", 3, 119.6495, 29.0895, "wucheng", '[\"å©ºåŸ\"]', "æµ™æ±Ÿçœ", "é‡‘åå¸‚", "å©ºåŸåŒº", None),
        ("330703", "é‡‘ä¸œåŒº", "330700", 3, 119.6774, 29.0992, "jindong", '[\"é‡‘ä¸œ\"]', "æµ™æ±Ÿçœ", "é‡‘åå¸‚", "é‡‘ä¸œåŒº", None),
        ("330723", "æ­¦ä¹‰å¿", "330700", 3, 119.8164, 28.8931, "wuyi", '[\"æ­¦ä¹‰\"]', "æµ™æ±Ÿçœ", "é‡‘åå¸‚", "æ­¦ä¹‰å¿", None),
        ("330726", "æµ¦æ±Ÿå¿", "330700", 3, 119.8918, 29.4536, "pujiang", '[\"æµ¦æ±Ÿ\"]', "æµ™æ±Ÿçœ", "é‡‘åå¸‚", "æµ¦æ±Ÿå¿", None),
        ("330727", "ç£å®‰å¿", "330700", 3, 120.4503, 29.0572, "panan", '[\"ç£å®‰\"]', "æµ™æ±Ÿçœ", "é‡‘åå¸‚", "ç£å®‰å¿", None),
        ("330781", "å…°æºªå¸‚", "330700", 3, 119.4596, 29.2085, "lanxi", '[\"å…°æºª\"]', "æµ™æ±Ÿçœ", "é‡‘åå¸‚", "å…°æºªå¸‚", None),
        ("330782", "ä¹‰ä¹Œå¸‚", "330700", 3, 120.0744, 29.3067, "yiwu", '[\"ä¹‰ä¹Œ\"]', "æµ™æ±Ÿçœ", "é‡‘åå¸‚", "ä¹‰ä¹Œå¸‚", None),
        ("330783", "ä¸œé˜³å¸‚", "330700", 3, 120.2419, 29.2612, "dongyang", '[\"ä¸œé˜³\"]', "æµ™æ±Ÿçœ", "é‡‘åå¸‚", "ä¸œé˜³å¸‚", None),
        ("330784", "æ°¸åº·å¸‚", "330700", 3, 120.0470, 28.8883, "yongkang", '[\"æ°¸åº·\"]', "æµ™æ±Ÿçœ", "é‡‘åå¸‚", "æ°¸åº·å¸‚", None),

        # è¡¢å·å¸‚åŒºå¿
        ("330802", "æŸ¯åŸåŒº", "330800", 3, 118.8724, 28.9417, "kecheng", '[\"æŸ¯åŸ\"]', "æµ™æ±Ÿçœ", "è¡¢å·å¸‚", "æŸ¯åŸåŒº", None),
        ("330803", "è¡¢æ±ŸåŒº", "330800", 3, 118.8964, 28.9702, "qujiang", '[\"è¡¢æ±Ÿ\"]', "æµ™æ±Ÿçœ", "è¡¢å·å¸‚", "è¡¢æ±ŸåŒº", None),
        ("330822", "å¸¸å±±å¿", "330800", 3, 118.5103, 28.9019, "changshan", '[\"å¸¸å±±\"]', "æµ™æ±Ÿçœ", "è¡¢å·å¸‚", "å¸¸å±±å¿", None),
        ("330824", "å¼€åŒ–å¿", "330800", 3, 118.4166, 29.1379, "kaihua", '[\"å¼€åŒ–\"]', "æµ™æ±Ÿçœ", "è¡¢å·å¸‚", "å¼€åŒ–å¿", None),
        ("330825", "é¾™æ¸¸å¿", "330800", 3, 119.1782, 29.0282, "longyou", '[\"é¾™æ¸¸\"]', "æµ™æ±Ÿçœ", "è¡¢å·å¸‚", "é¾™æ¸¸å¿", None),
        ("330881", "æ±Ÿå±±å¸‚", "330800", 3, 118.6285, 28.7385, "jiangshan", '[\"æ±Ÿå±±\"]', "æµ™æ±Ÿçœ", "è¡¢å·å¸‚", "æ±Ÿå±±å¸‚", None),

        # èˆŸå±±å¸‚åŒºå¿
        ("330902", "å®šæµ·åŒº", "330900", 3, 122.2072, 29.9853, "dinghai", '[\"å®šæµ·\"]', "æµ™æ±Ÿçœ", "èˆŸå±±å¸‚", "å®šæµ·åŒº", None),
        ("330903", "æ™®é™€åŒº", "330900", 3, 122.3019, 29.9506, "putuo_zs", '[\"æ™®é™€\"]', "æµ™æ±Ÿçœ", "èˆŸå±±å¸‚", "æ™®é™€åŒº", None),
        ("330921", "å²±å±±å¿", "330900", 3, 122.2038, 30.2459, "daishan", '[\"å²±å±±\"]', "æµ™æ±Ÿçœ", "èˆŸå±±å¸‚", "å²±å±±å¿", None),
        ("330922", "åµŠæ³—å¿", "330900", 3, 122.4532, 30.7269, "shengsi", '[\"åµŠæ³—\"]', "æµ™æ±Ÿçœ", "èˆŸå±±å¸‚", "åµŠæ³—å¿", None),

        # å°å·å¸‚åŒºå¿
        ("331002", "æ¤’æ±ŸåŒº", "331000", 3, 121.4286, 28.6614, "jiaojiang", '[\"æ¤’æ±Ÿ\"]', "æµ™æ±Ÿçœ", "å°å·å¸‚", "æ¤’æ±ŸåŒº", None),
        ("331003", "é»„å²©åŒº", "331000", 3, 121.2589, 28.6508, "huangyan", '[\"é»„å²©\"]', "æµ™æ±Ÿçœ", "å°å·å¸‚", "é»„å²©åŒº", None),
        ("331004", "è·¯æ¡¥åŒº", "331000", 3, 121.3732, 28.5802, "luqiao", '[\"è·¯æ¡¥\"]', "æµ™æ±Ÿçœ", "å°å·å¸‚", "è·¯æ¡¥åŒº", None),
        ("331022", "ä¸‰é—¨å¿", "331000", 3, 121.3937, 29.1053, "sanmen", '[\"ä¸‰é—¨\"]', "æµ™æ±Ÿçœ", "å°å·å¸‚", "ä¸‰é—¨å¿", None),
        ("331023", "å¤©å°å¿", "331000", 3, 121.0085, 29.1429, "tiantai", '[\"å¤©å°\"]', "æµ™æ±Ÿçœ", "å°å·å¸‚", "å¤©å°å¿", None),
        ("331024", "ä»™å±…å¿", "331000", 3, 120.7297, 28.8469, "xianju", '[\"ä»™å±…\"]', "æµ™æ±Ÿçœ", "å°å·å¸‚", "ä»™å±…å¿", None),
        ("331081", "æ¸©å²­å¸‚", "331000", 3, 121.3859, 28.3683, "wenling", '[\"æ¸©å²­\"]', "æµ™æ±Ÿçœ", "å°å·å¸‚", "æ¸©å²­å¸‚", None),
        ("331082", "ä¸´æµ·å¸‚", "331000", 3, 121.1389, 28.8560, "linhai", '[\"ä¸´æµ·\"]', "æµ™æ±Ÿçœ", "å°å·å¸‚", "ä¸´æµ·å¸‚", None),
        ("331083", "ç‰ç¯å¸‚", "331000", 3, 121.2339, 28.1363, "yuhuan", '[\"ç‰ç¯\"]', "æµ™æ±Ÿçœ", "å°å·å¸‚", "ç‰ç¯å¸‚", None),

        # ä¸½æ°´å¸‚åŒºå¿
        ("331102", "è²éƒ½åŒº", "331100", 3, 119.9218, 28.4519, "liandu", '[\"è²éƒ½\"]', "æµ™æ±Ÿçœ", "ä¸½æ°´å¸‚", "è²éƒ½åŒº", None),
        ("331121", "é’ç”°å¿", "331100", 3, 120.2877, 28.1359, "qingtian", '[\"é’ç”°\"]', "æµ™æ±Ÿçœ", "ä¸½æ°´å¸‚", "é’ç”°å¿", None),
        ("331122", "ç¼™äº‘å¿", "331100", 3, 120.0900, 28.6595, "jinyun", '[\"ç¼™äº‘\"]', "æµ™æ±Ÿçœ", "ä¸½æ°´å¸‚", "ç¼™äº‘å¿", None),
        ("331123", "é‚æ˜Œå¿", "331100", 3, 119.2764, 28.8490, "suichang", '[\"é‚æ˜Œ\"]', "æµ™æ±Ÿçœ", "ä¸½æ°´å¸‚", "é‚æ˜Œå¿", None),
        ("331124", "æ¾é˜³å¿", "331100", 3, 119.4820, 28.4506, "songyang", '[\"æ¾é˜³\"]', "æµ™æ±Ÿçœ", "ä¸½æ°´å¸‚", "æ¾é˜³å¿", None),
        ("331125", "äº‘å’Œå¿", "331100", 3, 119.5728, 28.1164, "yunhe", '[\"äº‘å’Œ\"]', "æµ™æ±Ÿçœ", "ä¸½æ°´å¸‚", "äº‘å’Œå¿", None),
        ("331126", "åº†å…ƒå¿", "331100", 3, 119.0627, 27.6186, "qingyuan", '[\"åº†å…ƒ\"]', "æµ™æ±Ÿçœ", "ä¸½æ°´å¸‚", "åº†å…ƒå¿", None),
        ("331127", "æ™¯å®ç•²æ—è‡ªæ²»å¿", "331100", 3, 119.6384, 27.9754, "jingning", '[\"æ™¯å®\"]', "æµ™æ±Ÿçœ", "ä¸½æ°´å¸‚", "æ™¯å®ç•²æ—è‡ªæ²»å¿", None),
        ("331181", "é¾™æ³‰å¸‚", "331100", 3, 119.1417, 28.0743, "longquan", '[\"é¾™æ³‰\"]', "æµ™æ±Ÿçœ", "ä¸½æ°´å¸‚", "é¾™æ³‰å¸‚", None),
    ]

    insert_sql = '''
        INSERT OR REPLACE INTO regions
        (code, name, parent_code, level, longitude, latitude, pinyin, aliases,
         province, city, district, street, data_source)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    '''

    added_count = 0
    updated_count = 0

    for data in zhejiang_data:
        try:
            cursor.execute(insert_sql, data)

            # æ£€æŸ¥æ˜¯æ–°å¢è¿˜æ˜¯æ›´æ–°
            cursor.execute("SELECT COUNT(*) FROM regions WHERE code = ? AND data_source != 'zhejiang_fix'", (data[0],))
            if cursor.fetchone()[0] > 0:
                updated_count += 1
                logger.info(f"âœ… å·²æ›´æ–°: {data[1]}")
            else:
                added_count += 1
                logger.info(f"âœ… å·²æ·»åŠ : {data[1]}")

        except Exception as e:
            logger.warning(f"âŒ å¤„ç†å¤±è´¥ {data[1]}: {e}")

    conn.commit()

    # éªŒè¯ä¿®å¤ç»“æœ
    logger.info(f"\nğŸ“Š æµ™æ±Ÿçœæ•°æ®ä¿®å¤å®Œæˆç»Ÿè®¡:")
    logger.info(f"   æ–°å¢è®°å½•: {added_count}ä¸ª")
    logger.info(f"   æ›´æ–°è®°å½•: {updated_count}ä¸ª")
    logger.info(f"   æ€»è®¡å¤„ç†: {added_count + updated_count}ä¸ª")

    # éªŒè¯ä½™æ­åŒº
    cursor.execute('SELECT code, name, level, province, city, district, longitude, latitude FROM regions WHERE name = \"ä½™æ­åŒº\"')
    yuhang_result = cursor.fetchone()

    if yuhang_result:
        logger.info(f"\nğŸ¯ ä½™æ­åŒºæ•°æ®éªŒè¯:")
        logger.info(f"   ä»£ç : {yuhang_result[0]}")
        logger.info(f"   åç§°: {yuhang_result[1]}")
        logger.info(f"   çº§åˆ«: {yuhang_result[2]} (å¿çº§)")
        logger.info(f"   çœä»½: {yuhang_result[3]}")
        logger.info(f"   åŸå¸‚: {yuhang_result[4]}")
        logger.info(f"   åŒºå¿: {yuhang_result[5]}")
        logger.info(f"   åæ ‡: ({yuhang_result[6]:.4f}, {yuhang_result[7]:.4f})")
        logger.info(f"   âœ… ä½™æ­åŒºæ•°æ®å·²ä¿®å¤!")
    else:
        logger.error(f"âŒ ä½™æ­åŒºæ•°æ®ä»ç„¶ç¼ºå¤±")

    # æ˜¾ç¤ºæµ™æ±Ÿçœç»Ÿè®¡
    cursor.execute("SELECT COUNT(*) FROM regions WHERE province = \"æµ™æ±Ÿçœ\"")
    zhejiang_total = cursor.fetchone()[0]

    cursor.execute('SELECT level, COUNT(*) FROM regions WHERE province = "æµ™æ±Ÿçœ" GROUP BY level ORDER BY level')
    zhejiang_stats = cursor.fetchall()

    logger.info(f"\nğŸ“Š æµ™æ±Ÿçœæ•°æ®ç»Ÿè®¡:")
    logger.info(f"   æ€»è®¡: {zhejiang_total}ä¸ªåœ°åŒº")
    for level, count in zhejiang_stats:
        level_name = {1: "çœçº§", 2: "åœ°çº§", 3: "å¿çº§"}.get(level, f"çº§åˆ«{level}")
        logger.info(f"   {level_name}: {count}ä¸ª")

    # æµ‹è¯•ä½™æ­åŒºåŒ¹é…
    from enhanced_place_matcher import EnhancedPlaceMatcher
    matcher = EnhancedPlaceMatcher()
    matcher.connect()

    result = matcher.match_place("ä½™æ­åŒº")
    if result:
        logger.info(f"\nğŸ‰ æµ‹è¯•ä½™æ­åŒºåŒ¹é…: âœ… æˆåŠŸ")
        logger.info(f"   åŒ¹é…ç»“æœ: {result['name']} ({result['level_name']})")
        logger.info(f"   åæ ‡: ({result['longitude']:.4f}, {result['latitude']:.4f})")
        logger.info(f"   çœä»½: {result.get('province', 'æœªçŸ¥')}")
        logger.info(f"   åŸå¸‚: {result.get('city', 'æœªçŸ¥')}")
    else:
        logger.error(f"\nâŒ ä½™æ­åŒºåŒ¹é…å¤±è´¥")

    matcher.close()
    conn.close()

if __name__ == "__main__":
    fix_zhejiang_data()