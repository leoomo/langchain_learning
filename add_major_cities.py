#!/usr/bin/env python3
"""
æ·»åŠ ä¸»è¦åŸå¸‚åˆ°æ•°æ®åº“
åŒ…å«çœä¼šåŸå¸‚å’Œé‡è¦åœ°çº§å¸‚
"""

import sqlite3
import json
from pathlib import Path

def add_major_cities():
    """æ·»åŠ ä¸»è¦åŸå¸‚åˆ°æ•°æ®åº“"""
    db_path = "data/admin_divisions.db"

    if not Path(db_path).exists():
        print("âŒ æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨")
        return

    conn = sqlite3.connect(db_path)
    cursor = conn.cursor()

    # ä¸»è¦çœä¼šåŸå¸‚å’Œé‡è¦åœ°çº§å¸‚
    major_cities = [
        # çœä¼šåŸå¸‚
        ("210100", "æ²ˆé˜³å¸‚", "210000", 2, 123.4315, 41.8057, "shenyang", '["ç››äº¬", "å¥‰å¤©"]'),
        ("220100", "é•¿æ˜¥å¸‚", "220000", 2, 125.3245, 43.8868, "changchun", '["æ˜¥åŸ", "åŒ—å›½æ˜¥åŸ"]'),
        ("230100", "å“ˆå°”æ»¨å¸‚", "230000", 2, 126.5358, 45.8023, "haerbin", '["å†°åŸ", "ä¸œæ–¹è«æ–¯ç§‘"]'),
        ("130100", "çŸ³å®¶åº„å¸‚", "130000", 2, 114.5149, 38.0428, "shijiazhuang", '["çŸ³é—¨"]'),
        ("140100", "å¤ªåŸå¸‚", "140000", 2, 112.5492, 37.8570, "taiyuan", '["å¹¶å·", "é¾™åŸ"]'),
        ("150100", "å‘¼å’Œæµ©ç‰¹å¸‚", "150000", 2, 111.7519, 40.8425, "huhehaote", '["é’åŸ", "å½’ç»¥"]'),
        ("320100", "å—äº¬å¸‚", "320000", 2, 118.7675, 32.0415, "nanjing", '["å®", "é‡‘é™µ", "å»ºåº·"]'),
        ("330100", "æ­å·å¸‚", "330000", 2, 120.1551, 30.2741, "hangzhou", '["æ­", "æ­¦æ—", "é’±å¡˜"]'),
        ("340100", "åˆè‚¥å¸‚", "340000", 2, 117.2272, 31.8206, "hefei", '["åºå·", "åˆæ·"]'),
        ("350100", "ç¦å·å¸‚", "350000", 2, 119.3063, 26.0745, "fuzhou", '["æ¦•åŸ", "å·¦æµ·", "ä¸‰å±±"]'),
        ("360100", "å—æ˜Œå¸‚", "360000", 2, 115.8922, 28.6765, "nanchang", '["æ´ªéƒ½", "è±«ç« "]'),
        ("370100", "æµå—å¸‚", "370000", 2, 117.0008, 36.6758, "jinan", '["æ³‰åŸ", "é½å·", "å†ä¸‹"]'),
        ("410100", "éƒ‘å·å¸‚", "410000", 2, 113.6254, 34.7466, "zhengzhou", '["å•†éƒ½", "ç»¿åŸ"]'),
        ("420100", "æ­¦æ±‰å¸‚", "420000", 2, 114.3055, 30.5928, "wuhan", '["æ±ŸåŸ", "æ±Ÿå¤", "æ¥š"]'),
        ("430100", "é•¿æ²™å¸‚", "430000", 2, 112.9825, 28.1959, "changsha", '["æ˜ŸåŸ", "æ½­å·"]'),
        ("440100", "å¹¿å·å¸‚", "440000", 2, 113.2644, 23.1291, "guangzhou", '["ç¾ŠåŸ", "èŠ±åŸ", "ç©—"]'),
        ("450100", "å—å®å¸‚", "450000", 2, 108.3669, 22.8170, "nanning", '["ç»¿åŸ", "é‚•åŸ"]'),
        ("460100", "æµ·å£å¸‚", "460000", 2, 110.3312, 20.0319, "haikou", '["æ¤°åŸ"]'),
        ("500100", "é‡åº†å¸‚", "500000", 2, 106.5516, 29.5630, "chongqing", '["æ¸", "å·´", "å±±åŸ"]'),
        ("510100", "æˆéƒ½å¸‚", "510000", 2, 104.0665, 30.5723, "chengdu", '["è“‰", "é”¦åŸ", "å¤©åºœ"]'),
        ("520100", "è´µé˜³å¸‚", "520000", 2, 106.7136, 26.5783, "guiyang", '["æ—åŸ", "ç­‘åŸ", "é‡‘é˜³"]'),
        ("530100", "æ˜†æ˜å¸‚", "530000", 2, 102.7103, 25.0446, "kunming", '["æ˜¥åŸ", "æ˜†"]'),
        ("540100", "æ‹‰è¨å¸‚", "540000", 2, 91.1322, 29.6604, "lasa", '["æ—¥å…‰åŸ", "é€»äº›"]'),
        ("610100", "è¥¿å®‰å¸‚", "610000", 2, 108.9402, 34.3416, "xian", '["é•¿å®‰", "é•äº¬", "è¥¿äº¬"]'),
        ("620100", "å…°å·å¸‚", "620000", 2, 103.8236, 36.0581, "lanzhou", '["é‡‘åŸ"]'),
        ("630100", "è¥¿å®å¸‚", "630000", 2, 101.7782, 36.6171, "xining", '["å¤éƒ½"]'),
        ("640100", "é“¶å·å¸‚", "640000", 2, 106.2309, 38.4872, "yinchuan", '["å‡¤åŸ", "å¡ä¸Šæ±Ÿå—"]'),
        ("650100", "ä¹Œé²æœ¨é½å¸‚", "650000", 2, 87.6277, 43.8256, "wulumuqi", '["ä¹Œå¸‚", "è¿ªåŒ–"]'),

        # é‡è¦åœ°çº§å¸‚
        ("320200", "æ— é”¡å¸‚", "320000", 2, 120.3017, 31.5747, "wuxi", '["å¤ªæ¹–æ˜ç "]'),
        ("320400", "å¸¸å·å¸‚", "320000", 2, 119.9463, 31.7720, "changzhou", '["é¾™åŸ"]'),
        ("320500", "è‹å·å¸‚", "320000", 2, 120.5853, 31.2989, "suzhou", '["å§‘è‹", "å¹³æ±Ÿ"]'),
        ("320600", "å—é€šå¸‚", "320000", 2, 120.8644, 32.0116, "nantong", '["åŒ—ä¸Šæµ·"]'),
        ("320700", "è¿äº‘æ¸¯å¸‚", "320000", 2, 119.2216, 34.5967, "lianyungang", '["æ¸¯åŸ"]'),
        ("320800", "æ·®å®‰å¸‚", "320000", 2, 119.0153, 33.5975, "huaian", '["æ·®é˜´"]'),
        ("320900", "ç›åŸå¸‚", "320000", 2, 120.1397, 33.3776, "yancheng", '["ç›é˜œ"]'),
        ("321000", "æ‰¬å·å¸‚", "320000", 2, 119.4215, 32.3932, "yangzhou", '["å¹¿é™µ"]'),
        ("321100", "é•‡æ±Ÿå¸‚", "320000", 2, 119.4520, 32.2044, "zhenjiang", '["äº¬å£", "æ¶¦å·"]'),
        ("321200", "æ³°å·å¸‚", "320000", 2, 119.9153, 32.4849, "taizhou", '["å‡¤åŸ"]'),
        ("330200", "å®æ³¢å¸‚", "330000", 2, 121.5439, 29.8683, "ningbo", '["ç”¬", "ç”¬åŸ"]'),
        ("330300", "æ¸©å·å¸‚", "330000", 2, 120.6994, 27.9944, "wenzhou", '["é¹¿åŸ"]'),
        ("330400", "å˜‰å…´å¸‚", "330000", 2, 120.7509, 30.7627, "jiaxing", '["ç¦¾åŸ"]'),
        ("330500", "æ¹–å·å¸‚", "330000", 2, 120.1024, 30.8672, "huzhou", '["æ¹–åŸ"]'),
        ("330600", "ç»å…´å¸‚", "330000", 2, 120.5821, 30.0293, "shaoxing", '["è¶Šå·", "ç»å…´"]'),
        ("330700", "é‡‘åå¸‚", "330000", 2, 119.6495, 29.0895, "jinhua", '["å©ºå·"]'),
        ("330800", "è¡¢å·å¸‚", "330000", 2, 118.8724, 28.9417, "quzhou", '["æŸ¯åŸ", "ä¿¡å®‰"]'),
        ("330900", "èˆŸå±±å¸‚", "330000", 2, 122.2072, 29.9853, "zhoushan", '["æµ·å¤©ä½›å›½", "æ¸”éƒ½"]'),
        ("331000", "å°å·å¸‚", "330000", 2, 121.4286, 28.6614, "taizhou_zj", '["å°å·"]'),
        ("331100", "ä¸½æ°´å¸‚", "330000", 2, 119.9218, 28.4519, "lishui", '["æ‹¬å·", "è²åŸ"]'),

        # é‡è¦åŒºå¿
        ("110108", "æµ·æ·€åŒº", "110000", 3, 116.2981, 39.9599, "haidian", '["æµ·æ·€"]'),
        ("110105", "æœé˜³åŒº", "110000", 3, 116.4436, 39.9214, "chaoyang", '["æœé˜³"]'),
        ("110102", "è¥¿åŸåŒº", "110000", 3, 116.3658, 39.9125, "xicheng", '["è¥¿åŸ"]'),
        ("110101", "ä¸œåŸåŒº", "110000", 3, 116.4168, 39.9283, "dongcheng", '["ä¸œåŸ"]'),
        ("310115", "æµ¦ä¸œæ–°åŒº", "310000", 3, 121.5447, 31.2218, "pudong", '["æµ¦ä¸œ"]'),
        ("310101", "é»„æµ¦åŒº", "310000", 3, 121.4903, 31.2332, "huangpu", '["é»„æµ¦"]'),
        ("310104", "å¾æ±‡åŒº", "310000", 3, 121.4368, 31.1880, "xuhui", '["å¾æ±‡"]'),
        ("310105", "é•¿å®åŒº", "310000", 3, 121.4222, 31.2202, "changning", '["é•¿å®"]'),
        ("310106", "é™å®‰åŒº", "310000", 3, 121.4482, 31.2292, "jingan", '["é™å®‰"]'),
        ("310107", "æ™®é™€åŒº", "310000", 3, 121.3956, 31.2500, "putuo", '["æ™®é™€"]'),
    ]

    insert_sql = '''
        INSERT OR REPLACE INTO regions
        (code, name, parent_code, level, longitude, latitude, pinyin, aliases)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?)
    '''

    try:
        cursor.executemany(insert_sql, major_cities)
        conn.commit()

        # éªŒè¯æ·»åŠ ç»“æœ
        cursor.execute("SELECT COUNT(*) as total FROM regions")
        total_count = cursor.fetchone()[0]

        cursor.execute("SELECT level, COUNT(*) FROM regions GROUP BY level ORDER BY level")
        level_stats = cursor.fetchall()

        print(f"âœ… æˆåŠŸæ·»åŠ  {len(major_cities)} ä¸ªä¸»è¦åŸå¸‚åˆ°æ•°æ®åº“")
        print(f"ğŸ“Š æ•°æ®åº“æ€»è®¡: {total_count} ä¸ªåœ°åŒº")
        print("ğŸ“‹ æŒ‰çº§åˆ«ç»Ÿè®¡:")
        for level, count in level_stats:
            level_name = {1: "çœçº§", 2: "åœ°çº§", 3: "å¿çº§", 4: "ä¹¡é•‡çº§"}.get(level, f"çº§åˆ«{level}")
            print(f"   {level_name}: {count}ä¸ª")

    except Exception as e:
        print(f"âŒ æ·»åŠ å¤±è´¥: {e}")
        conn.rollback()
    finally:
        conn.close()

if __name__ == "__main__":
    add_major_cities()